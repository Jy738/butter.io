<!DOCTYPE html>
<html>
  <head>
    <title>Butter.io</title>
    <style>
      html,body {
        width:100%;
        height:100%;
        padding:0;
        margin:0;
      }
    </style>
  </head>
  <body>
    <canvas width="800" height="600" id="content"></canvas>
    <script>
      let $ = (a) => {return document.getElementById(a);}
      let canvas = $('content');
      let ctx = canvas.getContext('2d');

      let collisions = {
        boundingBox: (rect1, rect2) => {
          let horizontalBound = (rect1.x + rect1.width > rect2.x && rect1.x < rect2.x + rect2.width);
          let verticalBound = (rect1.y + rect1.height > rect2.y && rect1.y < rect2.y + rect2.height);
          return horizontalBound && verticalBound;
        }
      }
      let player = {
        x: 0,
        y: 0,
        speeds: {
          accel: 1.01,
          maxAccel: 1.5,
          drag: 0
        },
        hitbox: {size: 70}
      }
      
      let keys = {w:false,a:false,s:false,d:false}
      let keylist = Object.keys(keys);
      document.onkeydown = (e) => {if(keylist.includes(e.key))keys[e.key] = true;}
      document.onkeyup = (e) => {if(keylist.includes(e.key))keys[e.key] = false;}
      
      function draw(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        if(keylist.some(r => keys[r] == true)){
          player.speeds.drag+=player.speeds.accel/1.5;
        } else {
          player.speeds.drag = 1;
        }
        if(keys.w)player.y-=(player.speeds.accel/2)*player.speeds.drag;
        if(keys.s)player.y+=(player.speeds.accel/2)*player.speeds.drag;
        if(keys.a)player.x-=(player.speeds.accel/2)*player.speeds.drag;
        if(keys.d)player.x+=(player.speeds.accel/2)*player.speeds.drag;
        
        ctx.fillStyle = "blue";
        ctx.fillRect(400,400,130,130);

        ctx.fillStyle = "red";
        ctx.fillRect(player.x,player.y,player.hitbox.size,player.hitbox.size);
        if(collisions.boundingBox(
          {x:player.x,y:player.y,width:player.hitbox.size,height:player.hitbox.size},
          {x:400,y:400,width:130,height:130}
        )){console.log("collided");}
        setTimeout(draw,5);
      }
      draw();
    </script>
  </body>
</html>
